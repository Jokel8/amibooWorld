<div id="characterArray" class="grid"></div>
<script>
    let id = 1;
    const container = document.getElementById("characterArray");

    async function fetchCharacter(id) {
        try {
            const response = await fetch(`../CMS/getCharacter.php?id=${id}&action=title`);
            if (!response.ok || response.status === 204) return false;

            const titleData = await response.json();
            const characterName = titleData.title;

            const characterDiv = document.createElement('div');
            characterDiv.className = 'character';

            const img = document.createElement('img');
            img.src = `../CMS/getCharacter.php?id=${id}`;
            img.alt = `Charakter ${id}`;

            const h2 = document.createElement('h2');
            h2.textContent = characterName;

            characterDiv.appendChild(img);
            characterDiv.appendChild(h2);
            container.appendChild(characterDiv);

            return true;
        } catch (error) {
            console.error('Fehler beim Laden des Charakters:', error);
            return false;
        }
    }

    async function loadCharacters() {
        var count = await fetch('../CMS/getAsset.php');
        count = await count.json();
        count = count.total;

        var success = 0;

        console.log(count);

        while (success < count) {
            success += await fetchCharacter(id);
            id++;
        }
    }

    loadCharacters();
</script>